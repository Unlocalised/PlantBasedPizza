name: Deploy Shared Services

on:
    push:
      branches:
        - main
        - feature/aws-serverless
      paths:
        - shared-infrastructure/*
    workflow_dispatch:

permissions:
  id-token: write
  contents: read

jobs:
  deploy-to-dev:
    uses: jeastham1993/PlantBasedPizza/.github/workflows/cdk-deploy-base.yaml
    with:
      cdk-folder: "shared-infrastructure"
      environment: "dev"
    secrets:
      deploy-role-arn: ${{secrets.DEPLOYMENT_ROLE_NAME}}